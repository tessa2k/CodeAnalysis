=== Following is the header of samples/93390/infercell/param.m ===
% PARAM.M
%
% Infer full compartmental model given only access to the voltage in the
% compartments. This code is released in conjunction with the paper 
%
%	Huys QJM, Ahrens M and Paninski L (2006): Efficient estimation of
%	detailed single-neurone models
%
% and can be downloaded from 
%
%	http://www.gatsby.ucl.ac.uk/~qhuys/code.html
%
% This script sets all the variables for the simulations. It is called by MAIN.M
%
% Copyright Quentin Huys 2006

%==========================================================================================
%			SIMULATION PARAMETERS
%==========================================================================================
nc = 30;			% number of compartments


=== Following is the header of samples/93390/infercell/setupquad.m ===
% SETUPQUAD.M
%
% Infer full compartmental model given only access to the voltage in the
% compartments. This code is released in conjunction with the paper 
%
%	Huys QJM, Ahrens M and Paninski L (2006): Efficient estimation of
%	detailed single-neurone models
%
% and can be downloaded from 
%
%	http://www.gatsby.ucl.ac.uk/~qhuys/code.html
%
% This script uses the voltage and current traces from GETDATA.M and sets up the
% matrices and vectors for the quadratic programme to be solved in MAIN.M: 
%
%	ahat = argmin_a (1/2*a'Aa + fa) s.t. a>0
%
% This script is called by MAIN.M
%
% Copyright Quentin Huys 2006


=== Following is the header of samples/93390/infercell/COPYRIGHT.txt ===
Copyright (C) 2006 Quentin Huys

This program is free software; you can redistribute it and/or modify it under
the terms of the GNU General Public License as published by the Free Software
Foundation; either version 2 of the License, or (at your option) any later
version.

This program is distributed in the hope that it will be useful, but WITHOUT ANY
WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with
this program; if not, write to the Free Software Foundation, Inc., 59 Temple
Place, Suite 330, Boston, MA 02111-1307 USA

Quentin Huys	

Email: 	qhuys@gatsby.ucl.ac.uk
Web:	http://www.gatsby.ucl.ac.uk/~qhuys



=== Following is the header of samples/93390/infercell/plotcell.m ===
% PLOTCELL.M
%
% Infer full compartmental model given only access to the voltage in the
% compartments. This code is released in conjunction with the paper 
%
%	Huys QJM, Ahrens M and Paninski L (2006): Efficient estimation of
%	detailed single-neurone models
%
% and can be downloaded from 
%
%	http://www.gatsby.ucl.ac.uk/~qhuys/code.html
%
% This script generates a plot of the cell if we are on a unix system
% this uses the GraphViz2Mat1.2 package, available from
% http://www.mathworks.com/matlabcentral/fileexchange/loadFile.do?objectId=4518&objectType=file
%
% Copyright Quentin Huys 2006

if isunix 
	for k=1:nc; Lbl{k}=' ';end


=== Following is the header of samples/93390/infercell/getdata.m ===
% GETDATA.M
%
% Infer full compartmental model given only access to the voltage in the
% compartments. This code is released in conjunction with the paper 
%
%	Huys QJM, Ahrens M and Paninski L (2006): Efficient estimation of
%	detailed single-neurone models
%
% and can be downloaded from 
%
%	http://www.gatsby.ucl.ac.uk/~qhuys/code.html
%
% This script uses parameters in PARAM.M and is called by MAIN.M. It 
%
%	a) generates the dendritic tree
%	b) simulates the cell
%	c) collects current and voltage traces needed for inference
%
% Copyright Quentin Huys 2006



=== Following is the header of samples/93390/infercell/getI.m ===
function I = getI(Ipar,t,nc);
%
% [I] = GETI(Ipar,t,nc);
%
% Infer full compartmental model given only access to the voltage in the
% compartments. This code is released in conjunction with the paper 
%
%	Huys QJM, Ahrens M and Paninski L (2006): Efficient estimation of
%	detailed single-neurone models
%
% and can be downloaded from 
%
%	http://www.gatsby.ucl.ac.uk/~qhuys/code.html
%
% This function evaluates the squared sinusoidal current injected into 
% the cell at each point in time t. 
%
% Copyright Quentin Huys 2006




=== Following is the header of samples/93390/infercell/main.m ===
% MAIN.M
%
% Infer full compartmental model given only access to the voltage in the
% compartments. This code is released in conjunction with the paper 
%
%	Huys QJM, Ahrens M and Paninski L (2006): Efficient estimation of
%	detailed single-neurone models
%
% and can be downloaded from 
%
%	http://www.gatsby.ucl.ac.uk/~qhuys/code.html
%
% This script is the main script. It calls PARAM.M to set the parameters of the
% cell to be simulated and used for inference. GETDATA.M simulates the cell and
% collects all the data needed to infer the parameters of interest. It calls
% GETI.M and also GENKINETCS.M as part of a call to a differential equation
% solver. SETUPQUAD.M sets up the quadratic programme to be solved. This is
% finally solved here.  PLOTS.M plots a small-scale version of figure 8 in the
% paper, and PLOTCELL.M finally plots the cells (you'll need some additional
% software for this, see in the file). 


=== Following is the header of samples/93390/infercell/README.txt ===
INTRO
======================================================================

Infer full compartmental model given only access to the voltage in the
compartments. This code is released in conjunction with the paper 

      Huys QJM, Ahrens M and Paninski L (2006): Efficient estimation of
      detailed single-neurone models

and can be downloaded from 

      http://www.gatsby.ucl.ac.uk/~qhuys/code.html

The paper can be downloaded from

      http://www.gatsby.ucl.ac.uk/~qhuys/pub/hap06.pdf

Copyright Quentin Huys 2006
qhuys@gatsby.ucl.ac.uk



=== Following is the header of samples/93390/infercell/LICENSE.txt ===
The GNU General Public License (GPL)
Version 2, June 1991

Copyright (C) 1989, 1991 Free Software Foundation, Inc.
59 Temple Place, Suite 330, Boston, MA 02111-1307 USA

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.

Preamble

The licenses for most software are designed to take away your freedom to share
and change it. By contrast, the GNU General Public License is intended to
guarantee your freedom to share and change free software--to make sure the
software is free for all its users. This General Public License applies to most
of the Free Software Foundation's software and to any other program whose
authors commit to using it. (Some other Free Software Foundation software is
covered by the GNU Library General Public License instead.) You can apply it to
your programs, too.



=== Following is the header of samples/93390/infercell/genkinetics.m ===
function [dV] = genkinetics(t,V,g,E,noise,delta,Tmax,C,R,W,nc,Ipar);
%
% [dV] = GENKINETICS.M
%
% Infer full compartmental model given only access to the voltage in the
% compartments. This code is released in conjunction with the paper 
%
%	Huys QJM, Ahrens M and Paninski L (2006): Efficient estimation of
%	detailed single-neurone models
%
% and can be downloaded from 
%
%	http://www.gatsby.ucl.ac.uk/~qhuys/code.html
%
% This function simulates the cell under scrutiny. It is called within the
% script GETDATA.M. 
%
% Copyright Quentin Huys 2006




=== Following is the header of samples/93390/infercell/plots.m ===
% PLOTS.M
%
% Infer full compartmental model given only access to the voltage in the
% compartments. This code is released in conjunction with the paper 
%
%	Huys QJM, Ahrens M and Paninski L (2006): Efficient estimation of
%	detailed single-neurone models
%
% and can be downloaded from 
%
%	http://www.gatsby.ucl.ac.uk/~qhuys/code.html
%
% This scripte generates a plot of the voltage trace and the parameters
% inferred. It is called by MAIN.M. It asks whether to generate an inset to
% visualise the amount of noise in the data. If the answer is yes, you get to
% select an area in the rightmost panel to enlarge. 
%
% Copyright Quentin Huys 2006

figure(1);


